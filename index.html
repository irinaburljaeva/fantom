<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>–®–ê–ì–ê–ô –î–û–ú–ê ‚Äî –ù–∞–π–¥–∏ –ü—Ä–∏–≤–∏–¥–µ–Ω–∏–µ –û—Å–µ–Ω–Ω–µ–≥–æ –õ–∞–≥–µ—Ä—è</title>
<style>
  :root{ --page:#fff; --text:#222428; --brand:#e24a27; --panel:#f6f7f8; --shadow:rgba(0,0,0,.10) }
  html,body{height:100%}
  body{margin:0;background:var(--page);color:var(--text);font:16px/1.45 Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}

  /* –í–≤–æ–¥–Ω—ã–π —ç–∫—Ä–∞–Ω */
  .intro{position:fixed;inset:0;z-index:20;display:grid;place-items:center;overflow:hidden;background:#000 center/cover no-repeat}
  .intro::before{content:"";position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,.35),rgba(0,0,0,.55))}
  .intro .panel{position:relative;width:min(920px,92vw);background:rgba(255,255,255,.88);color:#202226;border:1px solid rgba(0,0,0,.06);border-radius:16px;padding:18px;box-shadow:0 14px 40px var(--shadow);backdrop-filter:blur(4px)}
  .intro h1{margin:0 0 10px;font-size:22px}
  .intro blockquote{margin:12px 0;padding:12px;background:#fff;border-left:4px solid var(--brand);border-radius:8px}
  .btn{cursor:pointer;border:0;border-radius:12px;background:var(--brand);color:#fff;font-weight:700;padding:10px 14px;box-shadow:0 6px 18px rgba(226,74,39,.25)}

  /* HUD */
  .hud{position:sticky;top:0;display:flex;gap:10px;align-items:center;padding:10px 14px;background:linear-gradient(180deg,#fff,rgba(255,255,255,.86));z-index:5;border-bottom:1px solid rgba(0,0,0,.06)}
  .badge{display:inline-flex;gap:8px;align-items:center;background:#fff;padding:8px 12px;border-radius:999px;border:1px solid rgba(0,0,0,.06)}
  .brand{color:var(--brand);font-weight:700}
  .progress{flex:1;height:8px;background:#eceff1;border-radius:999px;overflow:hidden}
  .bar{height:100%;width:0;background:var(--brand);transition:width .35s ease}

  /* –ò–≥—Ä–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å + –ø—Ä–∞–≤—ã–π –±–ª–æ–∫ */
  .play-wrap{max-width:1200px;margin:18px auto;padding:0 12px;display:flex;gap:18px;align-items:flex-start;flex-wrap:wrap}
  .stage-wrap{position:relative;flex:1 1 680px;min-width:320px;aspect-ratio:16/10}
  .stage{position:relative;width:100%;height:100%;overflow:hidden;border-radius:16px;background:#ddd center/cover no-repeat;box-shadow:0 12px 36px var(--shadow);border:1px solid rgba(0,0,0,.06)}
  .layer{position:absolute;inset:0}
  #bg{transition:opacity .25s ease}
  .dock{width:100%;display:flex;gap:10px;align-items:center;justify-content:space-between;margin-top:10px}
  .pill{background:#fff;border:1px solid rgba(0,0,0,.06);border-radius:14px;padding:10px 14px;color:#444}

  .side{flex:0 0 min(360px,32vw);background:var(--panel);border:1px solid rgba(0,0,0,.06);border-radius:16px;padding:16px;box-shadow:0 10px 24px var(--shadow);display:none}
  .side h3{margin:6px 0 8px}
  .side .hint{margin:10px 0 0;background:#fff;border:1px dashed rgba(0,0,0,.2);border-radius:10px;padding:10px 12px}

  .toast{position:fixed;left:50%;bottom:18px;transform:translateX(-50%);background:#111;color:#fff;padding:10px 14px;border-radius:12px;display:none;box-shadow:0 10px 24px rgba(0,0,0,.25)}
  .loader{position:absolute;inset:0;display:grid;place-items:center;background:rgba(255,255,255,.35);z-index:4}
  .ring{width:42px;height:42px;border-radius:50%;border:4px solid rgba(0,0,0,.12);border-top-color:var(--brand);animation:spin .9s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>

<!-- –í–≤–æ–¥–Ω—ã–π —Å–ª–∞–π–¥ -->
<section id="intro" class="intro">
  <div class="panel">
    <h1>–û—Å–µ–Ω–Ω–∏–π –ª–∞–≥–µ—Ä—å ¬´–®–ê–ì–ê–ô –î–û–ú–ê¬ª</h1>
    <p>–í –ª–∞–≥–µ—Ä–µ –®–ê–ì–ê–ô –î–û–ú–ê –æ—Å–µ–Ω—å—é –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç —á—É–¥–µ—Å–∞. –û–¥–Ω–∞–∂–¥—ã –≤ —á–∞—Ç –ø—Ä–∏—à–ª–æ —Å—Ç—Ä–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞:</p>
    <blockquote>
      ¬´–ü—Ä–∏–≤–µ—Ç! –Ø –∂–∏–≤—É –∑–¥–µ—Å—å —Å –ø—Ä–æ—à–ª–æ–≥–æ —Å–µ–∑–æ–Ω–∞. –Ø –ª—é–±–ª—é —á–∞–π —Å –æ–±–ª–µ–ø–∏—Ö–æ–π, –æ—Å–µ–Ω–Ω–∏–µ –ª–∏—Å—Ç—å—è –∏ —à–∞–≥–∏ –ø–æ —É—Ç—Ä–µ–Ω–Ω–µ–π —Ä–æ—Å–µ. –ê –µ—â—ë —è –Ω–µ–º–Ω–æ–∂–∫–æ‚Ä¶ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π.¬ª
    </blockquote>
    <p>–¢–∞–∫ –≤—Å–µ —É–∑–Ω–∞–ª–∏ –ø—Ä–æ –ü—Ä–∏–≤–∏–¥–µ–Ω–∏–µ –û—Å–µ–Ω–Ω–µ–≥–æ –õ–∞–≥–µ—Ä—è ‚Äî –®–∞–≥—É–Ω—é. –û–Ω –Ω–µ –ø—É–≥–∞–µ—Ç, –∞ –ø–æ–º–æ–≥–∞–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è, –≥—Ä–µ—Ç—å—Å—è –∏ –Ω–µ –≥—Ä—É—Å—Ç–∏—Ç—å. –ò–≥—Ä–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è: –∑–∞ –Ω–µ–¥–µ–ª—é –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –®–∞–≥—É–Ω—é –Ω–∞ –≤—Å–µ—Ö –ª–æ–∫–∞—Ü–∏—è—Ö –ª–∞–≥–µ—Ä—è –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –µ–≥–æ –∑–∞–¥–∞–Ω–∏—è.</p>
    <footer><button id="startBtn" class="btn" type="button">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button></footer>
  </div>
</section>

<!-- HUD -->
<header class="hud">
  <div class="badge">–£—Ä–æ–≤–µ–Ω—å: <span id="levelLabel" class="brand">1/1</span></div>
  <div class="progress"><div id="progressBar" class="bar"></div></div>
  <button id="hintBtn" class="btn" type="button">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
</header>

<!-- –ò–≥—Ä–∞ -->
<section class="play-wrap" aria-hidden="true">
  <div class="stage-wrap">
    <div id="stage" class="stage">
      <div id="bg" class="layer"></div>
      <div id="actors" class="layer"></div>
      <div id="loader" class="loader" hidden><div class="ring"></div></div>
    </div>
    <div class="dock">
      <div id="levelTask" class="pill">–ù–∞–π–¥–∏ –®–∞–≥—É–Ω—é –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ</div>
      <div class="pill">–û—á–∫–∏: <span id="score">0</span></div>
    </div>
  </div>

  <!-- –ü—Ä–∞–≤—ã–π –±–ª–æ–∫ -->
  <aside id="sidePanel" class="side">
    <h3>–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ!</h3>
    <p>–ü–æ—Ä–∞ —Ä–∞–∑–æ–≥–Ω–∞—Ç—å —Å–æ–Ω. –Ø –ª—é–±–ª—é –Ω–∞—á–∏–Ω–∞—Ç—å –¥–µ–Ω—å —Å –ª—ë–≥–∫–∏—Ö —à–∞–≥–æ–≤ ‚Äî –∞ —Ç—ã?</p>
    <div class="hint">
      <div>üéØ <b>–ó–∞–¥–∞–Ω–∏–µ:</b> –ø—Ä–æ–π—Ç–∏ 300 —à–∞–≥–æ–≤ –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å –∑–∞—Ä—è–¥–∫—É –Ω–∞ 2 –º–∏–Ω—É—Ç—ã.</div>
      <div style="margin-top:6px;">üéÅ <b>–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:</b> –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∞–Ω–∏–º–∞—Ü–∏—è ‚Äî ¬´–¥—ã–º –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Å–µ—Ä–¥—Ü–µ¬ª.</div>
    </div>
  </aside>
</section>

<div id="toast" class="toast"></div>

<script>
/* === –ü—É—Ç–∏ –¥–ª—è GitHub (–∫–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è) === */
const ASSETS = {
  start: 'start.jpg',
  lvl1: 'lvl1.jpg',
  lvl1found: 'lvl1found.jpg'
};

const GAME_CONFIG = {
  levels: [{
    bg: ASSETS.lvl1,
    bgFound: ASSETS.lvl1found,
    hotspot: { x: 90, y: 46, w: 8, h: 18 },
    hint: ''
  }]
};

const $ = s => document.querySelector(s);
const intro = $('#intro'), startBtn = $('#startBtn');
const playWrap = document.querySelector('.play-wrap');
const stage = $('#stage'), bgLayer = $('#bg'), loader = $('#loader');
const sidePanel = $('#sidePanel'), hintBtn = $('#hintBtn');
const levelLabel = $('#levelLabel'), progressBar = $('#progressBar'), levelTask = $('#levelTask');
const toast = $('#toast');

let state = { levelIndex: 0, started:false };

function preload(src){
  return new Promise((res,rej)=>{
    const img=new Image();
    img.onload=()=>res(src);
    img.onerror=()=>rej(src);
    img.src=src;
  });
}
function setBg(url){
  bgLayer.style.opacity='0';
  setTimeout(()=>{ bgLayer.style.background=`center/cover no-repeat url('${url}')`; bgLayer.style.opacity='1'; },120);
}
function showToast(msg,t=1600){
  toast.textContent=msg; toast.style.display='block';
  clearTimeout(showToast.tid);
  showToast.tid=setTimeout(()=>toast.style.display='none',t);
}
function clickToPercent(e){
  const r=stage.getBoundingClientRect();
  return {x:(e.clientX-r.left)/r.width*100, y:(e.clientY-r.top)/r.height*100};
}
function pointInRect(pt,r){
  const L=r.x-r.w/2,R=r.x+r.w/2,T=r.y-r.h/2,B=r.y+r.h/2;
  return pt.x>=L&&pt.x<=R&&pt.y>=T&&pt.y<=B;
}

/* Intro –∑–∞–≥—Ä—É–∑–∫–∞ */
preload(ASSETS.start).then(src=>{
  intro.style.backgroundImage=`url('${src}')`;
}).catch(src=>{
  intro.style.background='#fff';
  intro.querySelector('.panel').insertAdjacentHTML('beforeend',
    `<p style="color:#b00020;margin-top:10px">‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å <code>${src}</code>. –ü—Ä–æ–≤–µ—Ä—å –ø—É—Ç—å –∏–ª–∏ –∏–º—è —Ñ–∞–π–ª–∞.</p>`);
});

/* –°—Ç–∞—Ä—Ç –∏–≥—Ä—ã */
startBtn.addEventListener('click', async ()=>{
  intro.style.display='none';
  playWrap.removeAttribute('aria-hidden');
  state.started=true;
  await startLevel(0);
});

async function startLevel(i){
  const L=GAME_CONFIG.levels[i];
  levelLabel.textContent=`${i+1}/${GAME_CONFIG.levels.length}`;
  progressBar.style.width=(i/GAME_CONFIG.levels.length*100)+'%';
  levelTask.textContent='–ù–∞–π–¥–∏ –®–∞–≥—É–Ω—é –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ';
  sidePanel.style.display='none';
  hintBtn.style.display=(i===0)?'none':'inline-flex';
  loader.hidden=false;

  try{
    await preload(L.bg);
    setBg(L.bg);
    if(L.bgFound) preload(L.bgFound);
  }catch(src){
    showToast('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å '+src,2200);
  }finally{
    loader.hidden=true;
  }

  stage.onclick=(ev)=>{
    const pt=clickToPercent(ev);
    if(L.hotspot&&pointInRect(pt,L.hotspot)){
      onFound(L);
    } else showToast('–ù–µ –∑–¥–µ—Å—å üòä –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë!');
  };
}

function onFound(L){
  stage.animate([{transform:'scale(1)'},{transform:'scale(1.04)'},{transform:'scale(1)'}],{duration:320});
  if(L.bgFound) setBg(L.bgFound);
  if(state.levelIndex===0){ sidePanel.style.display='block'; }
}

hintBtn.addEventListener('click', ()=>{
  if(state.levelIndex===0) return;
  showToast('–ü–æ–¥—Å–∫–∞–∑–∫–∞: –ø—Ä–∏—Å–º–æ—Ç—Ä–∏—Å—å –∫ —Å–≤–µ—Ç–ª—ã–º –ø—è—Ç–Ω–∞–º.',2200);
});
</script>
</body>
</html>
